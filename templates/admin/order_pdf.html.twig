{% block body %}
<style>
    body {
        font-family: Arial, sans-serif;
        font-size: 14px;
    }
    .header {
        border-bottom: 1px solid #ccc;
        margin-bottom: 10px;
        padding-bottom: 5px;
    }
    .row {
        display: flex;
        flex-wrap: nowrap; /* No wrapping so that everything fits in one page */
        justify-content: space-between;
        margin: 5px 0;
    }
    .col-md-6 {
        width: 48%;
    }
    .text-right {
        text-align: right;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        margin-bottom: 10px;
    }
    th, td {
        border: 1px solid #ccc;
        padding: 8px;
    }
    th {
        background-color: #f2f2f2;
    }
</style>

<div class="header">
    <div class="row">
        <div class="col-md-6">
            <h1>Devis N° D2023-{{ reservation.id }}</h1>
        </div>
        <div class="col-md-6 text-right">
            <img class="logo" src="{{ absolute_url(asset('img/logo.jpg')) }}" alt="Logo de l'entreprise" style="max-width: 150px;">
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-6">
            <p>Date d'émission: {{ "now"|date("d/m/Y") }}</p>
            <p>Date d'échéance: {{ "now"|date_modify('+1 month')|date("d/m/Y") }}</p>
        </div>
        <div class="col-md-6 text-right">
            <p>Exemple SARL</p>
            <p>Adresse de l'entreprise</p>
            <p>Code Postal - Ville de l'entreprise</p>
            <p>Téléphone / Email / Site Internet de l'entreprise</p>
        </div>
    </div>
</div>

<div class="info-section">
    <div class="row">
        <div class="col-md-6">
            <p>{{ reservation.prenom }} {{ reservation.nom }}</p>
            <p>{{ reservation.adresse }}</p>
            <p>{{ reservation.codePostal }} - {{ reservation.ville }}</p>
            <p>{{ reservation.email }}</p>
        </div>
    </div>
</div>

<table>
    <thead>
        <tr>
            <th>Désignation</th>
            <th>Quantité</th>
            <th>TVA %</th>
            <th>P.U. HT</th>
            <th>Montant TVA</th>
            <th>Total TTC</th>
        </tr>
    </thead>
    <tbody>
    {% set reservationTotal = 0 %}
    {% for detail in orderDetails %}
        {% set equipment = reservation.materiels|filter(equip => equip.id == detail.materiel_id)|first %}
        {% set itemTotal = equipment.prixLocation * detail.quantity %}
        {% set reservationTotal = reservationTotal + itemTotal %}
        {% set montantTva = itemTotal * 0.1 %}
        <tr>
            <td>{{ equipment.nom }}</td>
            <td>{{ detail.quantity }}</td>
            <td>10 %</td>
            <td>{{ equipment.prixLocation }} €</td>
            <td>{{ montantTva|number_format(2, ',', ' ') }} €</td>
            <td>{{ (itemTotal + montantTva)|number_format(2, ',', ' ') }} €</td>
        </tr>
    {% endfor %}
    </tbody>
    <tfoot>
        <tr>
            <td colspan="5" class="text-right">Total HT</td>
            <td>{{ reservationTotal|number_format(2, ',', ' ') }} €</td>
        </tr>
        <tr>
            <td colspan="5" class="text-right">Total TTC</td>
            <td>{{ (reservationTotal * 1.1)|number_format(2, ',', ' ') }} €</td>
        </tr>
    </tfoot>
</table>

<h4>Conditions de paiement</h4>
<p>Solde à la livraison</p>

<h4>Moyens de paiement</h4>
<p>Espèces - Virement BANCAIRE sur le compte: XXX</p>

<div class="row">
    <div class="col-md-6">
        <p>Exemple SARL au capital de 0,00 €</p>
        <p>RCS Nantes n° XXX XXX XXX - Numéro de TVA: XXX</p>
    </div>
    <div class="col-md-6 text-right">
        <p>Assurance: XXX</p>
    </div>
</div>

{% endblock %}
